# 視覺化餘料管理系統 - 專案規格書

## 1. 專案概述

本文件旨在闡明視覺化餘料管理系統的技術規格。專案主要目標為自動化測量廢料或剩餘材料的輪廓。系統將在指定工作範圍內拍攝材料影像，處理這些影像以計算材料的輪廓，並生成代表此輪廓的 DXF 檔案。最終的 DXF 檔案將儲存於網路附加儲存（NAS）中，以供存檔和後續使用。

本系統為單次觸發計算而設計，不要求即時（real-time）處理能力。

## 2. 目標與範圍

### 2.1. 範圍內 (In-Scope)
*   **影像擷取:** 從四台 CCD 相機擷取影像，以覆蓋指定的工作區域。
*   **輪廓偵測:** 處理擷取的影像，以識別並計算目標材料的外部輪廓。
*   **DXF 生成:** 將計算出的輪廓數據轉換為標準的 DXF 檔案格式。
*   **數據儲存:** 自動將生成的 DXF 檔案儲存到公司 NAS 上的指定位置。

### 2.2. 範圍外 (Out-of-Scope) (待確認)
*   即時影像處理或追蹤。
*   對材料的物理搬運或操作。
*   除簡單觸發機制外，提供給使用者操作的系統介面（除非另有規定）。
*   對材料的進階分析（例如：顏色、紋理、類型識別）。

## 3. 性能要求

*   **工作範圍:** 2公尺 * 4公尺
*   **輪廓精度:** 生成的 DXF 輪廓與實際材料尺寸的誤差必須在 **+/- 5mm** 以內。
*   **處理週期:** 系統應在收到定義的觸發信號後，完成單次測量的完整週期（從影像擷取到 DXF 檔案儲存）。

## 4. 系統架構

### 4.1. 硬體元件
| 元件 | 型號/規格 | 備註 |
| --- | --- | --- |
| Camera | (x4) MV-CH120-20GC | 12MP 解析度 (6464x4852)。 |
| 鏡頭 | (x4) MVL-KF0618M-12MPE | |
| 處理單元 | 搭載 N305 處理器的嵌入式電腦 | RAM 和儲存空間規格待確認 |
| 網路交換器 | 6 或 8 埠 PoE 路由器 | 為相機供電並連接設備 |
| 相機防護盒 | 鏡頭防塵防護盒 | 在工作環境中保護鏡頭 |
| 儲存設備 | NAS (網路附加儲存) | 客戶提供 |

### 4.2. 軟體與功能流程
1. **觸發:** 處理流程由一個觸發器啟動（例如：手動輸入、外部感測器）。
2. **影像擷取:** 四台 PoE 相機同時擷取工作區域的影像。
3. **影像處理:**
        *   影像被傳送到嵌入式電腦。
        *   進行鏡頭畸變校正 (De-warp)，消除鏡頭本身造成的變形。
        *   將四個校正後的畫面無縫拼接成一個代表整個 2m x 4m 工作區域的完整平面圖。
        *   輪廓偵測演算法被應用以識別材料的輪廓。
4. **DXF 轉換:** 將偵測到的輪廓（一組座標）轉換為 DXF 檔案格式。
5. **檔案傳輸:** 生成的 DXF 檔案根據預定義的命名規則命名，並儲存到 NAS 上的指定資料夾。

## 5. 關鍵績效指標 (KPIs) 與驗收標準

| KPI | 目標 | 測量方法 |
| --- | --- | --- |
| **輪廓精度** | +/- 5mm | 在工作區域放置一個已知尺寸的物體（例如：1m x 1m 的模板）。生成的 DXF 檔案尺寸必須在公差範圍內與模板匹配。此測試將在物體不同位置重複執行 10 次。 |
| **系統可靠性** | 完整週期的成功率 >99%。 | 在 200 次的測試運行中，因軟體或處理錯誤導致的失敗次數應少於 2 次。 |
| **處理時間** | TBD (待定) (例如：從觸發到檔案儲存於 60 秒內)。 | 測量 200 次測試週期中每一次所需的時間。 |

---

## 6. 與客戶的討論要點

以下要點需要釐清，以最終確定專案範圍並確保成功交付。

### 6.1. 技術與環境
1. **光照條件:** 工作環境的環境光是否一致且穩定？光線的波動會顯著影響影像品質和輪廓偵測的準確性。 *我們是否需要安裝專用且受控的照明系統？*
2. **相機安裝與校準:** 四台相機的實體安裝方案是什麼？我們需要一個穩固的安裝結構和精確的校準流程，以準確拼接影像並滿足 +/- 5mm 的精度要求。
3. **處理單元規格:** 雖然已知 CPU 為 N305，我們需要確認嵌入式電腦的完整規格（RAM、儲存空間）。這對於確保它能夠處理來自四台 12MP 相機的影像處理負載至關重要。
4. **觸發機制:** 應如何啟動測量流程？（例如：一個實體按鈕、一個軟體命令、或一個偵測到材料存在的感測器）。

### 6.2. 軟體與數據
5. **DXF 檔案規格:**
    * 是否有特定的 **DXF 版本**（例如：R14, 2000, 2018）要求，以確保與您現有系統的相容性？
    * 要求的 **檔案命名規則** 是什麼？（例如：`YYYYMMDD_HHMMSS.dxf`, `材料ID_時間戳.dxf`）。
6. **NAS 存取細節:**
    * 目標資料夾在 NAS 上的網路路徑是什麼？
    * 系統需要什麼樣的憑證或權限才能將檔案寫入此位置？
7. **錯誤處理:** 如果發生錯誤，系統應如何報告？（例如：如果無法偵測到輪廓，或 NAS 無法連線）。它應該儲存日誌檔案、發送警報，還是不執行任何操作？

### 6.3. 驗證
8. **精度驗證程序:** 我們提出使用已知尺寸的模板進行驗證的方法。此程序是否可作為最終驗收的標準？是否有其他我們應考慮的特定測試案例或材料？

---
